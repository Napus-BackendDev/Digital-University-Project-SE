{
    "openapi": "3.0.0",
    "info": {
        "title": "Digital University Project API",
        "version": "1.0.0",
        "description": "API Document starting with /api/v1"
    },
    "paths": {
        "/question": {
            "get": {
                "tags": [
                    "Question"
                ],
                "summary": "Get all question",
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            },
            "post": {
                "tags": [
                    "Question"
                ],
                "summary": "Create a question",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "questionText",
                                    "type"
                                ],
                                "properties": {
                                    "order": {
                                        "type": "number"
                                    },
                                    "questionText": {
                                        "type": "string"
                                    },
                                    "type": {
                                        "type": "string"
                                    },
                                    "required": {
                                        "type": "boolean"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    }
                }
            },
            "put": {
                "tags": [
                    "Question"
                ],
                "summary": "Update a question",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "_id"
                                ],
                                "properties": {
                                    "_id": {
                                        "type": "string"
                                    },
                                    "order": {
                                        "type": "number"
                                    },
                                    "questionText": {
                                        "type": "string"
                                    },
                                    "type": {
                                        "type": "string"
                                    },
                                    "required": {
                                        "type": "boolean"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Question"
                ],
                "summary": "Delete a question",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "_id"
                                ],
                                "properties": {
                                    "_id": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Deleted"
                    }
                }
            }
        },
        "/question/id": {
            "get": {
                "tags": [
                    "Question"
                ],
                "summary": "Get question by ID",
                "description": "Retrieve a specific question by ID",
                "parameters": [
                    {
                        "name": "_id",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Question ID"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/form": {
            "get": {
                "tags": [
                    "Form"
                ],
                "summary": "Get all forms",
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            },
            "post": {
                "tags": [
                    "Form"
                ],
                "summary": "Create a form",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "title": {
                                        "type": "string"
                                    },
                                    "can_duplicate": {
                                        "type": "boolean"
                                    },
                                    "status": {
                                        "type": "string"
                                    },
                                    "schedule": {
                                        "type": "object",
                                        "properties": {
                                            "mode": {
                                                "type": "string"
                                            },
                                            "startAt": {
                                                "type": "date"
                                            },
                                            "endAt": {
                                                "type": "date"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    }
                }
            },
            "put": {
                "tags": [
                    "Form"
                ],
                "summary": "Update a form",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "_id"
                                ],
                                "properties": {
                                    "_id": {
                                        "type": "string"
                                    },
                                    "title": {
                                        "type": "string"
                                    },
                                    "can_duplicate": {
                                        "type": "boolean"
                                    },
                                    "status": {
                                        "type": "string"
                                    },
                                    "schedule": {
                                        "type": "object",
                                        "properties": {
                                            "mode": {
                                                "type": "string"
                                            },
                                            "startAt": {
                                                "type": "date"
                                            },
                                            "endAt": {
                                                "type": "date"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Form"
                ],
                "summary": "Delete a form",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "_id"
                                ],
                                "properties": {
                                    "_id": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Deleted"
                    }
                }
            }
        },
        "/form/id": {
            "get": {
                "tags": [
                    "Form"
                ],
                "summary": "Get form by ID",
                "description": "Retrieve a specific form by ID",
                "parameters": [
                    {
                        "name": "_id",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Form ID"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/auth/register": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Register new user",
                "description": "Create a new user account",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "password": {
                                        "type": "string",
                                        "minLength": 6
                                    },
                                    "roleId": {
                                        "type": "string",
                                        "description": "Role ID to assign to the user"
                                    }
                                },
                                "required": [
                                    "name",
                                    "email",
                                    "password",
                                    "roleId"
                                ]
                            },
                            "example": {
                                "name": "Sai Leng",
                                "email": "sai@gmail.com",
                                "password": "sai123",
                                "roleId": "693454ebdd1b76f3b7416c6b"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/auth/login": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Login user",
                "description": "Authenticate user and return JWT token in cookie",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "password": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "email",
                                    "password"
                                ]
                            },
                            "example": {
                                "email": "sai@gmail.com",
                                "password": "sai123"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/auth/logout": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Logout user",
                "description": "Clear authentication token cookie",
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/response": {
            "get": {
                "tags": [
                    "Response"
                ],
                "summary": "Get all responses",
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            },
            "post": {
                "tags": [
                    "Response"
                ],
                "summary": "Submit a new response",
                "description": "Create a new response submission. The responder is automatically set from the authenticated user's JWT token.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "form",
                                    "answers"
                                ],
                                "properties": {
                                    "form": {
                                        "type": "string",
                                        "description": "Form ID"
                                    },
                                    "answers": {
                                        "type": "array",
                                        "items": {
                                            "type": "object",
                                            "properties": {
                                                "question": {
                                                    "type": "string"
                                                },
                                                "response": {}
                                            }
                                        }
                                    },
                                    "submittedAt": {
                                        "type": "string",
                                        "format": "date-time",
                                        "description": "Optional - defaults to now"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            },
            "put": {
                "tags": [
                    "Response"
                ],
                "summary": "Update a response",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "_id"
                                ],
                                "properties": {
                                    "_id": {
                                        "type": "string"
                                    },
                                    "responder": {
                                        "type": "string"
                                    },
                                    "form": {
                                        "type": "string"
                                    },
                                    "answers": {
                                        "type": "array",
                                        "items": {
                                            "type": "object",
                                            "properties": {
                                                "question": {
                                                    "type": "string"
                                                },
                                                "response": {}
                                            }
                                        }
                                    },
                                    "submittedAt": {
                                        "type": "date"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Response"
                ],
                "summary": "Delete a response",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "_id"
                                ],
                                "properties": {
                                    "_id": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    },
                    "responses": {
                        "200": {
                            "description": "Deleted"
                        }
                    }
                }
            }
        },
        "/response/form": {
            "get": {
                "tags": [
                    "Response"
                ],
                "summary": "Get responses by form ID",
                "parameters": [
                    {
                        "name": "form",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/response/user": {
            "get": {
                "tags": [
                    "Response"
                ],
                "summary": "Get responses by user ID",
                "parameters": [
                    {
                        "name": "responder",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/response/id": {
            "get": {
                "tags": [
                    "Response"
                ],
                "summary": "Get response by ID",
                "parameters": [
                    {
                        "name": "response_id",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/response/export": {
            "get": {
                "tags": [
                    "Response"
                ],
                "summary": "Export responses by form ID",
                "parameters": [
                    {
                        "name": "_id",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/response/delete": {
            "delete": {
                "tags": [
                    "Response"
                ],
                "summary": "Delete all responses by form ID",
                "parameters": [
                    {
                        "name": "_id",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Deleted"
                    }
                }
            }
        },
        "/role": {
            "get": {
                "tags": [
                    "Role"
                ],
                "summary": "Get all roles",
                "description": "Retrieve a list of all roles",
                "responses": {
                    "200": {
                        "description": "Success",
                        "content": {
                            "application/json": {
                                "example": {
                                    "data": [
                                        {
                                            "_id": "693454ebdd1b76f3b7416c6b",
                                            "name": "ADMIN",
                                            "description": "Administrator role",
                                            "permissions": [
                                                "VIEW_USERS",
                                                "DELETE_USER",
                                                "VIEW_FORMS",
                                                "CREATE_FORM",
                                                "UPDATE_FORM",
                                                "DELETE_FORM",
                                                "VIEW_RESPONSES",
                                                "SUBMIT_RESPONSES",
                                                "EXPORT_RESPONSES"
                                            ],
                                            "createdAt": "2025-12-06T15:00:00.000Z",
                                            "updatedAt": "2025-12-06T15:00:00.000Z"
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            },
            "post": {
                "tags": [
                    "Role"
                ],
                "summary": "Create a new role",
                "description": "Create a new role with permissions",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "description": "Role name (will be converted to uppercase)"
                                    },
                                    "description": {
                                        "type": "string",
                                        "description": "Role description"
                                    },
                                    "permissions": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of permission strings"
                                    }
                                },
                                "required": [
                                    "name"
                                ]
                            },
                            "example": {
                                "name": "MANAGER",
                                "description": "Manager role with limited permissions",
                                "permissions": [
                                    "manage_forms",
                                    "view_all_data"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Role created successfully"
                    }
                }
            },
            "put": {
                "tags": [
                    "Role"
                ],
                "summary": "Update role",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Role ID"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "description": {
                                        "type": "string"
                                    },
                                    "permissions": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        }
                                    }
                                }
                            },
                            "example": {
                                "name": "ADMIN",
                                "description": "Updated administrator role",
                                "permissions": [
                                    "manage_users",
                                    "manage_roles",
                                    "manage_forms",
                                    "manage_responses"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Role updated successfully"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Role"
                ],
                "summary": "Delete role",
                "description": "Delete a role by ID",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "_id": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "_id"
                                ]
                            },
                            "example": {
                                "_id": "693454ebdd1b76f3b7416c6b"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Role deleted successfully"
                    }
                }
            }
        },
        "/role/id": {
            "get": {
                "tags": [
                    "Role"
                ],
                "summary": "Get role by ID",
                "description": "Retrieve a specific role by ID",
                "parameters": [
                    {
                        "name": "_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Role ID"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        },
        "/role/id/permissions": {
            "put": {
                "tags": [
                    "Role"
                ],
                "summary": "Set role permissions",
                "parameters": [
                    {
                        "name": "_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Role ID"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "permissions": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        }
                                    }
                                },
                                "required": [
                                    "permissions"
                                ]
                            },
                            "example": {
                                "permissions": [
                                    "manage_users",
                                    "manage_forms",
                                    "view_all_data"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Permissions updated successfully"
                    }
                }
            }
        },
        "/role/id/permissions/add": {
            "post": {
                "tags": [
                    "Role"
                ],
                "summary": "Add permission to role",
                "parameters": [
                    {
                        "name": "_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Role ID"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "permission": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "permission"
                                ]
                            },
                            "example": {
                                "permission": "EXPORT_RESPONSES"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Permission added successfully"
                    }
                }
            }
        },
        "/role/id/permissions/remove": {
            "post": {
                "tags": [
                    "Role"
                ],
                "summary": "Remove permission from role",
                "parameters": [
                    {
                        "name": "_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Role ID"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "permission": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "permission"
                                ]
                            },
                            "example": {
                                "permission": "VIEW_USERS"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Permission removed successfully"
                    }
                }
            }
        },
        "/user": {
            "get": {
                "tags": [
                    "User"
                ],
                "summary": "Get all users",
                "description": "Retrieve a list of all users",
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            },
            "post": {
                "tags": [
                    "User"
                ],
                "summary": "Create a new user",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "password": {
                                        "type": "string"
                                    },
                                    "roles": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of role IDs"
                                    }
                                },
                                "required": [
                                    "name",
                                    "email",
                                    "password"
                                ]
                            },
                            "example": {
                                "name": "John Doe",
                                "email": "john@example.com",
                                "password": "securePassword123",
                                "roles": [
                                    "693454ebdd1b76f3b7416c6b"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Created"
                    }
                }
            },
            "put": {
                "tags": [
                    "User"
                ],
                "summary": "Update user",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "_id": {
                                        "type": "string"
                                    },
                                    "name": {
                                        "type": "string"
                                    },
                                    "email": {
                                        "type": "string"
                                    },
                                    "roles": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        }
                                    }
                                },
                                "required": [
                                    "_id"
                                ]
                            },
                            "example": {
                                "_id": "6934507ff4bd1edba77c6cad",
                                "name": "Jane Smith",
                                "email": "jane@example.com",
                                "roles": [
                                    "693454ebdd1b76f3b7416c6b"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated"
                    }
                }
            },
            "delete": {
                "tags": [
                    "User"
                ],
                "summary": "Delete user",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "_id": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "_id"
                                ]
                            },
                            "example": {
                                "_id": "6934507ff4bd1edba77c6cad"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Deleted"
                    }
                }
            }
        },
        "/user/id": {
            "get": {
                "tags": [
                    "User"
                ],
                "summary": "Get user by ID",
                "description": "Retrieve a specific user by ID",
                "parameters": [
                    {
                        "name": "_id",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "User ID"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success"
                    }
                }
            }
        }
    }
}